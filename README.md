# 图像标题生成器 (Image Title Generator) - 使用说明

这是一个自动化的亚马逊产品图像标题生成与数据处理工具（豆包版）。
它通过 AI (豆包大模型) 识别图片内容，自动生成标题，并将其与手机型号数据合并，最后按品牌整理成亚马逊上架模板格式。

## 主要功能

1. **AI 图像标题生成**：自动识别图片内容并生成中英文标题（亚马逊格式）。
2. **型号数据合并**：根据配置自动匹配手机型号和对应的尺寸信息。
3. **模板自动填充**：将处理后的数据自动填入预设的亚马逊上架模板 (`.xlsm`)。
4. **品牌自动分类**：根据手机型号（如 iPhone, Samsung）自动拆分并整理最终结果。

## 使用流程

### 1. 准备工作
- 确保计算机已安装 **Microsoft Excel**。
- 将待处理的图片放入一个文件夹（路径需在 `config.txt` 中配置）。
- 确保 `需要的excel文件` 文件夹内包含最新的 `型号.xlsx` 和 `上架模板.xlsm`。

### 2. 配置参数
- 编辑 `config.txt`，设置图片路径 (`IMAGE_FOLDER_PATH`) 和结果保存路径 (`RESULT_FOLDER_PATH`)。
- 确保 `.env` 文件中已填入有效的 `DOUBAO_API_KEY`。

### 3. 运行程序
- 双击运行 `dist\ImageTitleGenerator.exe`。
- 程序将自动执行完整流程：AI 生成标题 -> 合并型号 -> 应用模板 -> 按品牌整理。

### 4. 查看结果
- 处理完成后，结果将保存在您指定的 `RESULT_FOLDER_PATH` 文件夹中。
- 如果部分图片处理失败，请查看 `Failure` 文件夹中的记录。

## 配置文件说明

### 1. config.txt
- `IMAGE_FOLDER_PATH`: 存放待处理图片的文件夹路径。
- `RESULT_FOLDER_PATH`: 处理结果的保存路径。
- `PARENT_CLASS_GROUP_SIZE`: 多少张图片共用一个父类编号（通常设置为 2）。
- `MODEL_NAME`: 使用的豆包 AI 模型名称。

### 2. prompt.txt
- 用于控制 AI 生成标题时的风格、关键词和格式要求。

### 3. .env
- 存储敏感的 API 密钥信息。

## 目录结构

- `dist/`: 包含编译后的可执行程序。
- `Image Title Generation/`: 包含处理逻辑的 Python 脚本。
- `需要的excel文件/`: 包含程序运行所需的 Excel 模板和数据。
- `Result/`: 默认的结果输出文件夹。
- `Failure/`: 记录处理过程中出错的图片信息。

## 注意事项

1. 运行期间请勿打开或编辑相关的 Excel 模板文件，以免产生读写冲突。
2. 请保持网络畅通，AI 标题生成功能需要连接豆包 API。
3. 建议在正式大批量处理前，先用少量图片测试 `config.txt` 配置是否正确。

## 技术支持

如果您在使用过程中遇到任何问题，请联系技术开发人员。
